<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>YouTube Kereső</title>
    <style>
        body { font-family: Arial; max-width: 700px; margin: 40px auto; }
        input { width: 80%; padding: 10px; font-size: 18px; }
        button { padding: 10px 15px; font-size: 18px; }
        .result { margin-top: 20px; }
        .video { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #ccc; cursor: pointer; }
        #player { margin-top: 30px; }
    </style>
</head>
<body>

<h1>YouTube kereső</h1>

<input id="query" type="text" placeholder="Kereső kifejezés..." oninput="startSearch()">
<button onclick="searchYouTube()">Keresés</button>

<div id="results" class="result"></div>

<div id="player"></div>

<label>Hangerő:</label>
<input id="volumeSlider" type="range" min="0" max="100" value="50" oninput="setVolume(this.value)">

<script>
let timer = null;
let player;

function startSearch() {
    clearTimeout(timer);
    timer = setTimeout(() => { searchYouTube(); }, 500);
}

async function searchYouTube() {
    const query = document.getElementById("query").value;
    const resultsDiv = document.getElementById("results");

    if (query.length < 3) {
        resultsDiv.innerHTML = "<p>Írj be legalább 3 karaktert...</p>";
        return;
    }

    resultsDiv.innerHTML = "<p>Keresés folyamatban...</p>";

    const api = "AIzaSyAvqcZuWfXHENDGZOhjSKoKyaZe4xGtTVM";
    const URL = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=3&q=${encodeURIComponent(query)}&key=${api}`;

    const response = await fetch(URL);
    const data = await response.json();

    resultsDiv.innerHTML = "";

    if (!data.items) {
        resultsDiv.innerHTML = "<p>Nincs találat vagy hiba történt.</p>";
        return;
    }

    linkList.innerHTML = "";
    data.items.forEach(item => {
        const videoId = item.id.videoId;
        const title = item.snippet.title;
        const thumb = item.snippet.thumbnails.medium.url;

        linkList.innerHTML += `<p><a href=\"https://www.youtube.com/watch?v=${videoId}\" target=\"_blank\">${title}</a></p>`;

        const div = document.createElement("div");
        div.className = "video";
        div.innerHTML = `
            <h3>${title}</h3>
            <img src="${thumb}"><br>
            <span>Kattints a megnyitáshoz</span>
        `;
        div.onclick = () => embedVideo(videoId);

        resultsDiv.appendChild(div);
    });
}

function embedVideo(id) {
    document.getElementById("player").innerHTML = `
        <iframe id="ytFrame" width="600" height="340" src="https://www.youtube.com/embed/${id}?enablejsapi=1" frameborder="0" allow="autoplay"></iframe>
    `;

    setTimeout(() => {
        player = new YT.Player('ytFrame');
    }, 500);
}

function setVolume(v) {
    if (player && player.setVolume) {
        player.setVolume(v);
    }
}

// YouTube API betöltése
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
</script>

<div id="linkList" style="position: fixed; right: 20px; top: 40px; width: 250px; background: #f5f5f5; padding: 10px; border: 1px solid #ccc; border-radius: 8px; max-height: 80vh; overflow-y: auto;"></div>

</body>
</html>
